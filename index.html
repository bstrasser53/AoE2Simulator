<!DOCTYPE html>
<html>
<body onload="InitializeState();">

<h2>AoE Simulator</h2>
<p id="WrittenBy">Written by Bernhard Strasser ([o.p.]kanalratte). Version 0.1.</p>
<p id="UseOrReuse">Feel free to use or reuse this html & javascript code.</p>
<p id="Comment">Based on the gathering rate values of Spirit of the Law: <a href="https://www.youtube.com/watch?v=izBnksYw-kM">for gold & wood</a>, <a href="https://www.youtube.com/watch?v=MaqvJMEj69k&t=150s">for farms</a>.</p>


<br>
<label for="lPickedCiv">Which Civ?:</label>
<select name="sPickedCiv" id="sPickedCiv">
	<option value="Generic">Generic</option>
<!--	<option value="Khmer">Khmer</option>
	<option value="Slavs">Slavs</option>
	<option value="Aztecs">Aztecs</option>
	<option value="Berber">Berber</option>
	<option value="Mayans">Mayans</option>
	<option value="Burgundians">Burgundians</option>
	<option value="Portuguese">Portuguese</option> -->
</select>
<br>
<br>
<br>


<table id="CurResources">
	<tr>
		<th>Wood</th>
		<th>Food</th>
		<th>Gold</th>
		<th>Stone</th>
	</tr>
	<tr>
		<td id="CurWoodNumber">20</td>
		<td id="CurFoodNumber">200</td>
		<td id="CurGoldNumber">100</td>
		<td id="CurStoneNumber">200</td>
	</tr>
</table>


<br>
<br>
<br>


<!--Build Icons-->

<p id="TCs">TCs: &nbsp &nbsp  &nbsp  &nbsp &nbsp Barracks &nbsp &nbsp &nbsp Archeries &nbsp &nbsp &nbsp Stables &nbsp &nbsp &nbsp Monastaries &nbsp &nbsp &nbsp &nbsp Siege Workshops &nbsp &nbsp &nbsp Castles</p>
<input type="image" src="./Pix/villager.png" onClick="javascript:BuildUnit(AllInfo,'Villager')" width="40" height="40" />
<input type="image" src="./Pix/shepherd.png" onClick="javascript:BuildSheepVil(AllInfo)" width="40" height="40" />
<input type="image" src="./Pix/boar.webp" onClick="javascript:BuildBoarVil()" width="40" height="40" />
<input type="image" src="./Pix/deer.png" onClick="javascript:BuildDeerVil()" width="40" height="40" />
<input type="image" src="./Pix/tree.webp" onClick="javascript:BuildWoodVil()" width="40" height="40" />

<input type="image" src="./Pix/ArrowRight.png" onClick="javascript:AdvanceToNextEvent()" width="40" height="40" />

<br>
<!--<input type="image" src="./Pix/farmer.png" onClick="javascript:CalcGatherratesAndUpdateOutput()" width="40" height="40" />-->
<!--<input type="image" src="./Pix/gold_miner.png" onClick="javascript:CalcGatherratesAndUpdateOutput()" width="40" height="40" />-->
<!--<input type="image" src="./Pix/stone_miner.png" onClick="javascript:CalcGatherratesAndUpdateOutput()" width="40" height="40" />-->
<!--<input type="image" src="./Pix/wheelbarrow.png" onClick="javascript:CalcGatherratesAndUpdateOutput()" width="40" height="40" />-->
<!--<input type="image" src="./Pix/hand_cart.png" onClick="javascript:CalcGatherratesAndUpdateOutput()" width="40" height="40" />-->




<!--
<form>
  <table id="InputTable">
    <tr>
      <td align="right">Vils on Farms:</td>
      <td align="left"><input type="number" value="10" name="VilsOnFarms" /></td>
    </tr>
    <tr>
      <td align="right">Vils on Wood:</td>
      <td align="left"><input type="number" value="18" name="VilsOnWood" /></td>
    </tr>
    <tr>
      <td align="right">Vils on Gold:</td>
      <td align="left"><input type="number" value="6" name="VilsOnGold" /></td>
    </tr>
    <tr>
      <td align="right">Number of Town Centers:</td>
      <td align="left"><input type="number" value="1" name="NoOfTCs" /></td>
    </tr>
  </table>
</form>
-->


<br>
<br>
<br>
<br>

<p id="Output0"></p>
<p id="Output1"></p>
<p id="Output2"></p>
<p id="Output3"></p>
<p id="Output4"></p>
<p id="Output5"></p>
<p id="Output6"></p>


<!-- DEBUG: -->
<!-- ->
<p id="Output7"></p>
<p id="Output8"></p>
<p id="Output9"></p>
<p id="Output10"></p>
<!- -->


<script>


var AllInfo;
function InitializeState() 
{
	
	AllInfo = {
		StateHistory: {
			Time: 0,
			Resources: [200,200,100,200],		// Wood, Food, Gold, Stone
			VilDistribution: {
				Idle: 3,
				Builders: 0,
				Shepherds: 0,
				BoarHunters: 0,
				DeerHunters: 0,
				Lumberjacks: 0,
				StragglerLumberjacks: 0,
				Farmers: 0,
				GoldMiners: 0,
				StoneMiners: 0
			}
		},
		Events: [{
		EventTime: 0,
		EventFunction: ""
		}]
	};
		

	WriteOutResources(AllInfo);

	//return AllInfo;
}


function WriteOutResources(AllInfo) {

	document.getElementById("CurWoodNumber").innerHTML =  AllInfo.StateHistory.Resources[0];
	document.getElementById("CurFoodNumber").innerHTML =  AllInfo.StateHistory.Resources[1];
	document.getElementById("CurGoldNumber").innerHTML =  AllInfo.StateHistory.Resources[2];
	document.getElementById("CurStoneNumber").innerHTML =  AllInfo.StateHistory.Resources[3];
}



function BuildUnit(AllInfo,UnitName) {

	//AllInfo.StateHistory.Resources = AllInfo.StateHistory.Resources - UnitStats(UnitName).Costs;
	UnitStatsTmp = UnitStats(UnitName);
	AllInfo.StateHistory.Resources = subtractvector(AllInfo.StateHistory.Resources, UnitStatsTmp.Cost);
	WriteOutResources(AllInfo);

	// Add Event to Add Unit
	// Determine where to add the event
	// var IndexOfEvent = DetermineEventIndex(AllInfo,AllInfo.StateHistory.Time + UnitStatsTmp.TrainTime);
	var IndexOfEvent = AllInfo.Events.length;
	AllInfo.Events[IndexOfEvent] = {EventTime: AllInfo.StateHistory.Time + UnitStatsTmp.TrainTime, EventFunction: "AddUnit(" + UnitName + ")"	};	
	document.getElementById("Output1").innerHTML =  AllInfo.Events[0].EventTime;
	document.getElementById("Output3").innerHTML =  AllInfo.Events.length;
	return AllInfo;
}


function BuildSheepVil(AllInfo) {
	

	AllInfo = BuildUnit(AllInfo,'Villager');
	
	// AddEvent("IncreaseVillager(AllInfo)")
	//SendIdleVilToSheep()
	//WriteOutResources(AllInfo);


}

/*
function BuildBoarVil() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}

function BuildDeerVil() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}

function BuildWoodVil() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}

function BuildFarmVil() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}

function BuildGoldVil() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}

function BuildStoneVil() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}

function BuildBoarVil() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}

function BuildWheelbarrow() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}
function BuildHandcart() {

	BuildUnit("Villager")
	//SendIdleVilToBoar()

}
*/

function UnitStats(UnitName) {
	Stats = {
		Cost: 0,
		OccupyBuilding: "",		// Wood, Food, Gold, Stone
		TrainTime: 0
	};
	if (UnitName === "Villager")
	{
		Stats.Cost = [0, 50, 0, 0];
		Stats.OccupyBuilding = "TownCenter"
		Stats.TrainTime = 25;
	}
	return Stats;

}


function addvector(a,b){
    return a.map((e,i) => e + b[i]);
}
function subtractvector(a,b){
    return a.map((e,i) => e - b[i]);
}


</script>


</body>
</html>
